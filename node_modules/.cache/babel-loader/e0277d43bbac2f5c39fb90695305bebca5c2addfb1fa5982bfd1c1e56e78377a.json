{"ast":null,"code":"var _s = $RefreshSig$();\n// src/hooks/useSubscription.js\n\nimport { useContext } from 'react';\nimport { SubscriptionContext } from '../context/SubscriptionContext';\n\n/**\r\n * Hook for accessing subscription functionality\r\n * Works with the tokenized, accountless subscription system\r\n */\nexport const useSubscription = () => {\n  _s();\n  const context = useContext(SubscriptionContext);\n  if (!context) {\n    throw new Error('useSubscription must be used within a SubscriptionProvider');\n  }\n  return {\n    // Subscription state\n    isSubscribed: context.isSubscribed,\n    isLoading: context.isLoading,\n    plan: context.plan,\n    expiresAt: context.expiresAt,\n    error: context.error,\n    // Subscription actions\n    purchaseSubscription: context.purchaseSubscription,\n    activateTokenFromEmail: context.activateTokenFromEmail,\n    refreshSubscription: context.refreshSubscription,\n    // Helper functions\n    isPremiumFeatureAvailable: featureName => {\n      // If not subscribed, check if it's a free feature\n      if (!context.isSubscribed) {\n        const freeFeatures = ['basic_search', 'limited_alerts'];\n        return freeFeatures.includes(featureName);\n      }\n\n      // If subscribed, check if the feature is available in their plan\n      const featureMap = {\n        monthly_premium: ['premium_deals', 'unlimited_alerts', 'priority_notifications', 'full_search'],\n        yearly_premium: ['premium_deals', 'unlimited_alerts', 'priority_notifications', 'full_search', 'historical_data', 'price_predictions']\n      };\n\n      // Allow access if subscribed and feature exists in their plan\n      return context.plan && featureMap[context.plan] && featureMap[context.plan].includes(featureName);\n    },\n    // Get the days remaining in subscription\n    getDaysRemaining: () => {\n      if (!context.isSubscribed || !context.expiresAt) return 0;\n      const now = new Date();\n      const expiry = new Date(context.expiresAt);\n      const diffTime = expiry - now;\n      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n      return Math.max(0, diffDays);\n    },\n    // Format expiry date for display\n    getFormattedExpiryDate: () => {\n      if (!context.expiresAt) return 'N/A';\n      const date = new Date(context.expiresAt);\n      return date.toLocaleDateString(undefined, {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      });\n    }\n  };\n};\n_s(useSubscription, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport default useSubscription;","map":{"version":3,"names":["useContext","SubscriptionContext","useSubscription","_s","context","Error","isSubscribed","isLoading","plan","expiresAt","error","purchaseSubscription","activateTokenFromEmail","refreshSubscription","isPremiumFeatureAvailable","featureName","freeFeatures","includes","featureMap","monthly_premium","yearly_premium","getDaysRemaining","now","Date","expiry","diffTime","diffDays","Math","ceil","max","getFormattedExpiryDate","date","toLocaleDateString","undefined","year","month","day"],"sources":["C:/Users/juliu/Desktop/web/src/hooks/useSubscription.js"],"sourcesContent":["// src/hooks/useSubscription.js\r\n\r\nimport { useContext } from 'react';\r\nimport { SubscriptionContext } from '../context/SubscriptionContext';\r\n\r\n/**\r\n * Hook for accessing subscription functionality\r\n * Works with the tokenized, accountless subscription system\r\n */\r\nexport const useSubscription = () => {\r\n  const context = useContext(SubscriptionContext);\r\n  \r\n  if (!context) {\r\n    throw new Error('useSubscription must be used within a SubscriptionProvider');\r\n  }\r\n  \r\n  return {\r\n    // Subscription state\r\n    isSubscribed: context.isSubscribed,\r\n    isLoading: context.isLoading,\r\n    plan: context.plan,\r\n    expiresAt: context.expiresAt,\r\n    error: context.error,\r\n    \r\n    // Subscription actions\r\n    purchaseSubscription: context.purchaseSubscription,\r\n    activateTokenFromEmail: context.activateTokenFromEmail,\r\n    refreshSubscription: context.refreshSubscription,\r\n    \r\n    // Helper functions\r\n    isPremiumFeatureAvailable: (featureName) => {\r\n      // If not subscribed, check if it's a free feature\r\n      if (!context.isSubscribed) {\r\n        const freeFeatures = ['basic_search', 'limited_alerts'];\r\n        return freeFeatures.includes(featureName);\r\n      }\r\n      \r\n      // If subscribed, check if the feature is available in their plan\r\n      const featureMap = {\r\n        monthly_premium: [\r\n          'premium_deals',\r\n          'unlimited_alerts',\r\n          'priority_notifications',\r\n          'full_search',\r\n        ],\r\n        yearly_premium: [\r\n          'premium_deals',\r\n          'unlimited_alerts', \r\n          'priority_notifications',\r\n          'full_search',\r\n          'historical_data',\r\n          'price_predictions'\r\n        ]\r\n      };\r\n      \r\n      // Allow access if subscribed and feature exists in their plan\r\n      return context.plan && \r\n             featureMap[context.plan] && \r\n             featureMap[context.plan].includes(featureName);\r\n    },\r\n    \r\n    // Get the days remaining in subscription\r\n    getDaysRemaining: () => {\r\n      if (!context.isSubscribed || !context.expiresAt) return 0;\r\n      \r\n      const now = new Date();\r\n      const expiry = new Date(context.expiresAt);\r\n      const diffTime = expiry - now;\r\n      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n      \r\n      return Math.max(0, diffDays);\r\n    },\r\n    \r\n    // Format expiry date for display\r\n    getFormattedExpiryDate: () => {\r\n      if (!context.expiresAt) return 'N/A';\r\n      \r\n      const date = new Date(context.expiresAt);\r\n      return date.toLocaleDateString(undefined, {\r\n        year: 'numeric',\r\n        month: 'long',\r\n        day: 'numeric'\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\nexport default useSubscription;"],"mappings":";AAAA;;AAEA,SAASA,UAAU,QAAQ,OAAO;AAClC,SAASC,mBAAmB,QAAQ,gCAAgC;;AAEpE;AACA;AACA;AACA;AACA,OAAO,MAAMC,eAAe,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACnC,MAAMC,OAAO,GAAGJ,UAAU,CAACC,mBAAmB,CAAC;EAE/C,IAAI,CAACG,OAAO,EAAE;IACZ,MAAM,IAAIC,KAAK,CAAC,4DAA4D,CAAC;EAC/E;EAEA,OAAO;IACL;IACAC,YAAY,EAAEF,OAAO,CAACE,YAAY;IAClCC,SAAS,EAAEH,OAAO,CAACG,SAAS;IAC5BC,IAAI,EAAEJ,OAAO,CAACI,IAAI;IAClBC,SAAS,EAAEL,OAAO,CAACK,SAAS;IAC5BC,KAAK,EAAEN,OAAO,CAACM,KAAK;IAEpB;IACAC,oBAAoB,EAAEP,OAAO,CAACO,oBAAoB;IAClDC,sBAAsB,EAAER,OAAO,CAACQ,sBAAsB;IACtDC,mBAAmB,EAAET,OAAO,CAACS,mBAAmB;IAEhD;IACAC,yBAAyB,EAAGC,WAAW,IAAK;MAC1C;MACA,IAAI,CAACX,OAAO,CAACE,YAAY,EAAE;QACzB,MAAMU,YAAY,GAAG,CAAC,cAAc,EAAE,gBAAgB,CAAC;QACvD,OAAOA,YAAY,CAACC,QAAQ,CAACF,WAAW,CAAC;MAC3C;;MAEA;MACA,MAAMG,UAAU,GAAG;QACjBC,eAAe,EAAE,CACf,eAAe,EACf,kBAAkB,EAClB,wBAAwB,EACxB,aAAa,CACd;QACDC,cAAc,EAAE,CACd,eAAe,EACf,kBAAkB,EAClB,wBAAwB,EACxB,aAAa,EACb,iBAAiB,EACjB,mBAAmB;MAEvB,CAAC;;MAED;MACA,OAAOhB,OAAO,CAACI,IAAI,IACZU,UAAU,CAACd,OAAO,CAACI,IAAI,CAAC,IACxBU,UAAU,CAACd,OAAO,CAACI,IAAI,CAAC,CAACS,QAAQ,CAACF,WAAW,CAAC;IACvD,CAAC;IAED;IACAM,gBAAgB,EAAEA,CAAA,KAAM;MACtB,IAAI,CAACjB,OAAO,CAACE,YAAY,IAAI,CAACF,OAAO,CAACK,SAAS,EAAE,OAAO,CAAC;MAEzD,MAAMa,GAAG,GAAG,IAAIC,IAAI,CAAC,CAAC;MACtB,MAAMC,MAAM,GAAG,IAAID,IAAI,CAACnB,OAAO,CAACK,SAAS,CAAC;MAC1C,MAAMgB,QAAQ,GAAGD,MAAM,GAAGF,GAAG;MAC7B,MAAMI,QAAQ,GAAGC,IAAI,CAACC,IAAI,CAACH,QAAQ,IAAI,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;MAE5D,OAAOE,IAAI,CAACE,GAAG,CAAC,CAAC,EAAEH,QAAQ,CAAC;IAC9B,CAAC;IAED;IACAI,sBAAsB,EAAEA,CAAA,KAAM;MAC5B,IAAI,CAAC1B,OAAO,CAACK,SAAS,EAAE,OAAO,KAAK;MAEpC,MAAMsB,IAAI,GAAG,IAAIR,IAAI,CAACnB,OAAO,CAACK,SAAS,CAAC;MACxC,OAAOsB,IAAI,CAACC,kBAAkB,CAACC,SAAS,EAAE;QACxCC,IAAI,EAAE,SAAS;QACfC,KAAK,EAAE,MAAM;QACbC,GAAG,EAAE;MACP,CAAC,CAAC;IACJ;EACF,CAAC;AACH,CAAC;AAACjC,EAAA,CA5EWD,eAAe;AA8E5B,eAAeA,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}